<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="org.kosta.finalproject.lego.mapper.CommunityBoardMapper">
	<insert id="posting" parameterType="org.kosta.finalproject.lego.vo.BoardVO">
		insert into board(board_no,board_title,board_content,category_no,hits,board_date,likes,id) values(board_seq.nextval,#{boardTitle},#{boardContent},#{bcvo.categoryNo},#{hits},sysdate,#{likes},#{mvo.id})
	</insert> 
	<select id="findBCVO" parameterType="int" resultType="org.kosta.finalproject.lego.vo.BoardCategoryVO">
		select category_name, category_no from board_category where category_no=#{value}
	</select>
	
	
	
	
	<resultMap type="BoardVO" id="memberResultMap">
		<result column="name" property="mvo.name"/>
		<result column="id" property="mvo.id"/>
		<result column="category_no" property="bcvo.categoryNo"/>
		<result column="category_name" property="bcvo.categoryName"/>
	</resultMap>
	
	<select id="findAllCommunityList"  resultMap="memberResultMap" resultType="org.kosta.finalproject.lego.vo.BoardVO">
			select b.* , m.*,c.*
			from board b, member m, board_category c
			where b.category_no=#{bcvo.categoryNo}
			and c.category_no = b.category_no
			and b.id=m.id order by board_no desc
	</select>
	
<!-- 	<resultMap type="org.kosta.finalproject.lego.vo.BoardVO" id="categoryResultMap" extends="memberResultMap">
		<result column="category_no" property="bcvo.categroyNo"/>
		<result column="category_name" property="bcvo.categoryName"/>
	</resultMap> -->
	
	<select id="findBoardDetailByBoardNo" parameterType="int" resultMap="memberResultMap" resultType="org.kosta.finalproject.lego.vo.BoardVO">
		select b.*,m.*,bc.*
		from board b, member m, board_category bc
		where b.id=m.id
		and bc.category_no = b.category_no
		and b.board_no=#{value}
	</select>
	
	<update id="updateByBoardVO" parameterType="org.kosta.finalproject.lego.vo.BoardVO"  >
		UPDATE board SET board_title=#{boardTitle},board_content=#{boardContent}, category_no=#{bcvo.categoryNo} WHERE board_no =#{boardNo}
	</update>
	
	<delete id="deleteByBoardVO" parameterType="org.kosta.finalproject.lego.vo.BoardVO">
		DELETE FROM board WHERE board_no = #{boardNo}
	</delete>

</mapper>